/*
 * bmp280.c
 *
 *  Created on: 14. 11. 2020
 *      Author: Stancoj
 */

#include "bmp280_app.h"


struct bmp280_dev bmp;
struct bmp280_config bmp_conf;
struct bmp280_uncomp_data bmp_ucomp_data;

bmp280_sensor_data_ BMP280_data = {0};

bool initBMP280_app(void)
{
	int8_t rslt = 0;

	bmp.delay_ms = LL_mDelay;
	bmp.dev_id = BMP280_I2C_ADDR_SEC;
	bmp.intf = BMP280_I2C_INTF;
	bmp.read = i2c_bmp280_read;
	bmp.write = i2c_bmp280_write;

	rslt = bmp280_init(&bmp);
	if(rslt != BMP280_OK) return false;

	rslt = bmp280_get_config(&bmp_conf, &bmp);
	if(rslt != BMP280_OK) return false;

	// Set configuration
	bmp_conf.filter = BMP280_FILTER_COEFF_2;
	bmp_conf.os_temp = BMP280_OS_4X;
	bmp_conf.os_pres = BMP280_OS_4X;
	bmp_conf.odr = BMP280_ODR_1000_MS;

    rslt = bmp280_set_config(&bmp_conf, &bmp);
	if(rslt != BMP280_OK) return false;

	return true;
}
